Существует три варианта работы с git-сервером (например, gitlab). Указанные варианты различаются протоколами взаимодействия между клиентом и сервером, и используются следующие варинты: http, https и ssh.

Протокол http позволяет только читать из репозитория, и не позволяет что-то в него дописывать. Это связано с небезопасностью http, а именно возможностью атаки "третий в середине" (main-in-the-middle).

Протоколы https и ssh позволяют чтение и запись в репозиторий. Для работы https у сервера должен быть https-сертификат, и при его наличии работу с репозиторием можно вести с помощью пароля. Каждая git-команда взаимодействия с сервером (git push, git pull) требует ввода пароля. В наших условиях https не настроен, поэтому остаётся последний вариант - протокол ssh. Для его работы не требуется знание пароля, а требуется наличие файла особого вида - ssh-ключа. В статье приведён порядок создания ssh-ключа и его добавления в учетную запись gitlab, что позволяет вести работу с личным репозиторием.

1. Для созданного в gitlab нового проекта на вкладке overview вам показано множество команд для работы с этим репозиторием. Скопируйте их в notepad++ на рабочий стол хоста в файл git.txt, они пригодятся нам позже. После создания файла эта подсказка пропадает, и с вами останется только локальная копия в git.txt.

1. Создание ssh-ключа
    * В консоли виртуальной машины выполнить (bash или terminal в PyCharm)

    ```bash
    ssh-keygen
    ```
    * Внимательно прочитать вывод, нажать enter на каждый вариант - при нажатии enter будет выбрано то значение по умолчанию, что указано в скобках после вопроса. По указанному на первом шаге пути будет лежать ключ. Два файла /home/an/.ssh/id_rsa и id_rsa.pub нужно скопировать в свой сетевой каталог \\\\rackstation\home, и в начале каждого занятия на новой виртуалке копировать эти два файла на нужное место. Они используются для авторизации вас в gitlabnto;
    * Выполнить

    ```bash
    cat ~/.ssh/id_rsa.pub
    ```
    * Полученный вывод (ваш открытый ключ) скопировать в настройки проекта в gitlabnto (справа сверху - settings, в меню слева SSH keys, скопировать ключ в key, указать в title название my_key), убедиться в корректном добавлении ключа;

1. Начало работы с репозиторием:

    **Вариант 1. Добавление уже созданных файлов в новый проект gitlab на примере проекта для python**
    * В PyCharm открыть вкладку терминал, выполнить код из сохранённого ранее git.txt из раздела Existing folder

    ```bash
    git init
    # замените anetto на свой ник
    git remote add origin ssh://git@gitlabnto:2222/anetto/python.git
    git add printer.py 
    git commit -m "Initial commit"
    git push -u origin master
    # на запрос про unknown host написать yes
    ```

    **Вариант 2. Создание нового репозитория для проекта вне IDE**
    * Открыть терминал на рабочем столе. Вывод **pwd** должен писать /home/an/Рабочий стол. 
    * Если pwd даёт /home/an, то выполните

    ```bash
    cd Рабочий\ стол
    ```
    * Возвращаемся в файл git.txt, полученный ранее. Выполняем из него несколько команд (использовать **свои данные**, а не указанные ниже). Обратите внимание, что для **git clone** нужно дописать ssh:// в начало и порт 2222 в середину по аналогии с примером ниже

    ```bash
    git config --global user.name "user"
    git config --global user.email "user@1.ru"
    
    git clone ssh://git@gitlabnto:2222/user/timp.git
    ```
    * На рабочем столе появился каталог timp с содержимым вашего репозитория; Выполните
    
    ```bash
    cd timp
    ```
1. Дальнейшая простая работа с git заключается в выполнении команд
    
    ```bash
    # добавляем изменённый файл в "подготовленное к коммиту"
    git add printer.py
    # сохраняем изменения локально
    git commit -m 'fixed zero division bug'
    # сохраняем на сервер
    git push origin master
    ```

    Или можно ещё проще
    ```bash
    # добавляем и коммитим все изменения локально
    git commit -am 'fixed zero division bug'
    # сохраняем на сервер
    git push origin master
    ```


1. Для работы с gitlab с другого компьютера необходимо одно из двух:
    * Два файла /home/an/.ssh/id_rsa и id_rsa.pub нужно скопировать в свой сетевой каталог \\\\rackstation\home, и в начале каждого занятия на новой виртуалке копировать эти два файла на нужное место. Они используются для авторизации вас в gitlabnto
    * Каждый раз пересоздавать новый ключ и добавлять его в учётную запись gitlab.