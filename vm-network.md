## Сетевое взаимодействие в VMware Workstation и VMware Server
###  Принципы организации сетей между виртуальными машинами

Виртуальные машины на платформе VMware позволяют пользователям создавать различные комбинации виртуальных систем, работающих по различным принципам сетевого взаимодействия. Основой сети VMware являются следующие компоненты:

* виртуальные коммутаторы (Virtual Switches)
* виртуальные сетевые интерфейсы (aVirtual Ethernet Adapters)
* виртуальный мост (Virtual Bridge)
* встроенный DHCP-сервер
* устройство трансляции сетевых адресов (NAT, Network Address Translation)

Фундаментальным элементом сетевого взаимодействия в VMware Workstation и VMware Server является виртуальный коммутатор. Он обеспечивает сетевое взаимодействие виртуальных машин на манер физического устройства: на виртуальном коммутаторе есть порты, к которым могут быть привязаны виртуальные сетевые интерфейсы виртуальных машин, а также другие компоненты виртуальной инфраструктуры в пределах хоста. Несколько виртуальных машин, подключенных к одному виртуальному коммутатору, принадлежат одной подсети. Виртуальный мост представляет собой механизм, посредством которого происходит привязка физического сетевого адаптера компьютера к виртуальным сетевым интерфейсам. Встроенный DHCP-сервер VMware позволяет виртуальным машинам автоматически получать IP-адрес в своей подсети, а виртуальное NAT-устройство обеспечивает трансляцию сетевых адресов при общении виртуальных машин с внешней сетью.

### Виды сетевого взаимодействия между виртуальными машинами
* Bridged
* Host-Only
* NAT

### Bridged Networking
Этот тип сетевого взаимодействия позволяет привязать сетевой адаптер виртуальной машины к физическому сетевому интерфейсу компьютера, что дает возможность разделять ресурсы сетевой карты между хостовой и виртуальной системой. Виртуальная машина с таким типом сетевого взаимодействия будет вести себя по отношению к внешней сети хостовой системы как независимый компьютер. Вы можете назначить такой машине собственный IP-адрес в домашней сети или сети организации, либо она получит его от внешнего DHCP-сервера. Для создаваемой виртуальной машины этот тип сетевого взаимодействия назначается по умолчанию, поскольку это наиболее простой способ организации сетевого взаимодействия между виртуальной машиной, хостом и внешней сетью. Структура Bridged Networking приведена ниже.

![bridged_1_](/uploads/e23a6293ce48124dd2be9616aea0d60b/bridged_1_.jpg)

Виртуальный сетевой адаптер гостевой системы подключается к виртуальному коммутатору VMnet0, к которому также подключен виртуальный мост, взаимодействующий напрямую с физическим сетевым адаптером.

**Резюмируя вышесказанное**, виртуальная машина с таким типом сетевого подключения будет вести себя по отношению к внешней сети, как независимый компьютер.

### Host-Only Networking
Такой тип сетевого взаимодействия подходит для целей тестирования программного обеспечения, когда вам требуется организовать виртуальную сеть в пределах хоста, а виртуальным машинам не требуется выход во внешнюю сеть. В виртуальной подсети действует DHCP-сервер, подключенный к виртуальному коммутатору VMnet1 и назначающий виртуальным машинам IP-адреса из заданного диапазона (по умолчанию 192.168.179.128 — 192.168.179.254). Структура Host-Only Networking приведена ниже:

![host-only_1_](/uploads/670f387ff0054ed63523fd44d1928c64/host-only_1_.jpg)

Виртуальные сетевые адаптеры гостевых систем подключаются к коммутатору VMnet1 и взаимодействуют в подсети 192.168.179.0/24. В хостовой системе создается также виртуальный сетевой интерфейс, подключенный к VMnet1, который позволяет взаимодействовать с виртуальными машинами.

**Резюмируя вышесказанное**, виртуальная машина с таким типом сетевого подключения образует частную сеть с хостом и не имеет доступа к физической сети хоста.

### NAT Networking


Этот тип сетевого взаимодействия очень похож на Host-Only, за одним исключением: к виртуальному коммутатору VMnet8 подключается устройство трансляции IP-адресов (NAT). К этому коммутатору также подключается DHCP-сервер, раздающий виртуальным машинам адреса из заданного диапазона (по умолчанию 192.168.89.128 — 192.168.89.254) и, непосредственно, сами виртуальные машины. NAT-устройство позволяет осуществлять трансляцию IP-адресов, что позволяет виртуальным машинам инициировать соединения во внешнюю сеть, не предоставляя при этом механизма доступа к виртуальным машинам извне. Структура NAT Networking приведена ниже:

![nat_1_](/uploads/c192bb064bb5c89ed67f48de62591c26/nat_1_.jpg)


В хостовой операционной системе также как и для Host-Only Networking создается виртуальный сетевой интерфейс для коммутатора VMnet 8, позволяющий хосту общаться с виртуальными машинами.

Такая модель сетевого взаимодействия оптимальна с точки зрения безопасности (поскольку невозможно инициировать извне соединение с виртуальной машиной), однако существенно снижает быстродействие сети (иногда, до 20-30 процентов). NAT-соединение может использоваться, например, для безопасной работы в Интернет из виртуальной машины.

**Резюмируя вышесказанное**, при использовании такого типа сетевого подключения виртуальная машина собственного IP адреса внешней сети, при этом она может подключаться к внешней сети, используя IP и MAC адреса хостовой машины.